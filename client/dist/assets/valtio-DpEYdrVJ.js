import{r as P,R as F}from"./react-CYTwke-y.js";import{h as k,y as I,p as N,a as $,w as G}from"./proxy-compare-DB6eqWzY.js";import{u as J}from"./use-sync-external-store-DOzTnoXh.js";const W={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},z=r=>typeof r=="object"&&r!==null,m=new WeakMap,v=new WeakSet,Q=(r=Object.is,y=(e,u)=>new Proxy(e,u),w=e=>z(e)&&!v.has(e)&&(Array.isArray(e)||!(Symbol.iterator in e))&&!(e instanceof WeakMap)&&!(e instanceof WeakSet)&&!(e instanceof Error)&&!(e instanceof Number)&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof RegExp)&&!(e instanceof ArrayBuffer),a=e=>{switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e}},f=new WeakMap,l=(e,u,E=a)=>{const p=f.get(e);if((p==null?void 0:p[0])===u)return p[1];const h=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return k(h,!0),f.set(e,[u,h]),Reflect.ownKeys(e).forEach(b=>{if(Object.getOwnPropertyDescriptor(h,b))return;const S=Reflect.get(e,b),{enumerable:M}=Reflect.getOwnPropertyDescriptor(e,b),o={value:S,enumerable:M,configurable:!0};if(v.has(S))k(S,!1);else if(S instanceof Promise)delete o.value,o.get=()=>E(S);else if(m.has(S)){const[V,O]=m.get(S);o.value=l(V,O(),E)}Object.defineProperty(h,b,o)}),Object.preventExtensions(h)},d=new WeakMap,i=[1,1],g=e=>{if(!z(e))throw new Error("object required");const u=d.get(e);if(u)return u;let E=i[0];const p=new Set,h=(s,n=++i[0])=>{E!==n&&(E=n,p.forEach(t=>t(s,n)))};let b=i[1];const S=(s=++i[1])=>(b!==s&&!p.size&&(b=s,o.forEach(([n])=>{const t=n[1](s);t>E&&(E=t)})),E),M=s=>(n,t)=>{const c=[...n];c[1]=[s,...c[1]],h(c,t)},o=new Map,V=(s,n)=>{if((W?"production":void 0)!=="production"&&o.has(s))throw new Error("prop listener already exists");if(p.size){const t=n[3](M(s));o.set(s,[n,t])}else o.set(s,[n])},O=s=>{var n;const t=o.get(s);t&&(o.delete(s),(n=t[1])==null||n.call(t))},K=s=>(p.add(s),p.size===1&&o.forEach(([t,c],_)=>{if((W?"production":void 0)!=="production"&&c)throw new Error("remove already exists");const A=t[3](M(_));o.set(_,[t,A])}),()=>{p.delete(s),p.size===0&&o.forEach(([t,c],_)=>{c&&(c(),o.set(_,[t]))})}),j=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e)),D=y(j,{deleteProperty(s,n){const t=Reflect.get(s,n);O(n);const c=Reflect.deleteProperty(s,n);return c&&h(["delete",[n],t]),c},set(s,n,t,c){const _=Reflect.has(s,n),A=Reflect.get(s,n,c);if(_&&(r(A,t)||d.has(t)&&r(A,d.get(t))))return!0;O(n),z(t)&&(t=I(t)||t);let L=t;if(t instanceof Promise)t.then(R=>{t.status="fulfilled",t.value=R,h(["resolve",[n],R])}).catch(R=>{t.status="rejected",t.reason=R,h(["reject",[n],R])});else{!m.has(t)&&w(t)&&(L=g(t));const R=!v.has(L)&&m.get(L);R&&V(n,R)}return Reflect.set(s,n,L,c),h(["set",[n],t,A]),!0}});d.set(e,D);const q=[j,S,l,K];return m.set(D,q),Reflect.ownKeys(e).forEach(s=>{const n=Object.getOwnPropertyDescriptor(e,s);"value"in n&&(D[s]=e[s],delete n.value,delete n.writable),Object.defineProperty(j,s,n)}),D})=>[g,m,v,r,y,w,a,f,l,d,i],[T]=Q();function se(r={}){return T(r)}function X(r,y,w){const a=m.get(r);(W?"production":void 0)!=="production"&&!a&&console.warn("Please use proxy object");let f;const l=[],d=a[3];let i=!1;const e=d(u=>{l.push(u),f||(f=Promise.resolve().then(()=>{f=void 0,i&&y(l.splice(0))}))});return i=!0,()=>{i=!1,e()}}function B(r,y){const w=m.get(r);(W?"production":void 0)!=="production"&&!w&&console.warn("Please use proxy object");const[a,f,l]=w;return l(a,f(),y)}const Y={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},{use:U}=F,{useSyncExternalStore:Z}=J,x=(r,y)=>{const w=P.useRef();P.useEffect(()=>{w.current=G(r,y)}),P.useDebugValue(w.current)},C=new WeakMap;function re(r,y){const a=P.useRef(),f=P.useRef();let l=!0;const d=Z(P.useCallback(e=>{const u=X(r,e);return e(),u},[r,void 0]),()=>{const e=B(r,U);try{if(!l&&a.current&&f.current&&!N(a.current,e,f.current,new WeakMap))return a.current}catch{}return e},()=>B(r,U));l=!1;const i=new WeakMap;P.useEffect(()=>{a.current=d,f.current=i}),(Y?"production":void 0)!=="production"&&x(d,i);const g=P.useMemo(()=>new WeakMap,[]);return $(d,i,g,C)}export{se as p,re as u};
